<view class="chat-page">
  <scroll-view scroll-y class="messages-scroll" scroll-into-view="msg-{{messages.length - 1}}">
    <view wx:if="{{conversation}}" class="chat-info">
      <text class="info-text">与 {{conversation.userName}} 的私信</text>
      <text class="post-title">关于: {{conversation.postTitle}}</text>
    </view>
    
    <view class="messages-list">
      <view 
        wx:for="{{messages}}" 
        wx:key="id"
        id="msg-{{index}}"
        class="message-item {{item.isSelf ? 'self' : 'other'}}"
      >
        <system-avatar wx:if="{{!item.isSelf}}" avatar="{{userAvatar}}" size="small" />
        <view class="message-content">
          <text class="message-text">{{item.content}}</text>
        </view>
        <system-avatar wx:if="{{item.isSelf}}" avatar="{{item.senderAvatar}}" size="small" />
      </view>
    </view>
  </scroll-view>

  <view class="input-bar">
    <t-input 
      class="message-input"
      placeholder="输入消息..." 
      value="{{inputValue}}"
      bind:change="onInputChange"
      bind:confirm="onSendMessage"
    />
    <t-button theme="primary" size="medium" bindtap="onSendMessage">
      发送
    </t-button>
  </view>
</view>
